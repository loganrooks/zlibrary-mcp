{
  "version": "1.0",
  "updated": "2025-10-18",
  "description": "Performance budgets for RAG pipeline operations",

  "operations": {
    "xmark_detection_per_page": {
      "description": "opencv LSD line detection + diagonal filtering + pairing",
      "target_ms": 5.0,
      "max_ms": 10.0,
      "current_ms": 5.2,
      "status": "within_budget"
    },
    "garbled_detection_per_region": {
      "description": "Statistical analysis (entropy, symbol density, repetition)",
      "target_ms": 1.0,
      "max_ms": 2.0,
      "current_ms": 0.75,
      "status": "under_target"
    },
    "garbled_detection_fast_per_page": {
      "description": "Simplified symbol count (no entropy) for pre-filter",
      "target_ms": 0.5,
      "max_ms": 1.0,
      "current_ms": 0.01,
      "status": "excellent"
    },
    "ocr_recovery_per_page": {
      "description": "Tesseract OCR at 300 DPI",
      "target_ms": 300,
      "max_ms": 500,
      "current_ms": 320,
      "status": "within_budget"
    },
    "text_extraction_per_page": {
      "description": "PyMuPDF get_text()",
      "target_ms": 10,
      "max_ms": 20,
      "current_ms": 2.24,
      "status": "excellent"
    },
    "pdf_rendering_300dpi": {
      "description": "PyMuPDF get_pixmap() for X-mark detection",
      "target_ms": 2.0,
      "max_ms": 5.0,
      "current_ms": 2.0,
      "status": "at_target"
    }
  },

  "end_to_end": {
    "small_pdf_26_pages": {
      "description": "Derrida pages 110-135 (2 pages with X-marks)",
      "target_ms": 3000,
      "max_ms": 5000,
      "current_ms": 830,
      "pages": 2,
      "ms_per_page": 415,
      "status": "excellent"
    },
    "medium_pdf_330_pages": {
      "description": "Margins of Philosophy (est. 10 X-marks, annotations)",
      "target_ms": 5000,
      "max_ms": 10000,
      "current_ms": null,
      "pages": 330,
      "status": "not_tested"
    },
    "large_pdf_600_pages": {
      "description": "Being and Time full (est. 5 X-marks)",
      "target_ms": 10000,
      "max_ms": 20000,
      "current_ms": null,
      "pages": 600,
      "status": "not_tested"
    }
  },

  "optimization_targets": {
    "fast_prefilter": {
      "description": "Use fast garbled check to trigger selective X-mark detection",
      "expected_speedup": "31×",
      "expected_xmark_cost_ms": 53,
      "status": "designed_not_implemented"
    },
    "adaptive_resolution": {
      "description": "Start 72 DPI, escalate to 150/300 only if needed",
      "expected_speedup": "4-8×",
      "expected_rendering_ms": 0.5,
      "status": "designed_not_implemented"
    },
    "parallel_xmark_detection": {
      "description": "ProcessPoolExecutor with 4 workers",
      "expected_speedup": "4×",
      "current_speedup": "4×",
      "status": "implemented"
    }
  },

  "quality_gates": {
    "pre_commit": {
      "max_total_test_time_seconds": 60,
      "max_single_test_time_seconds": 10,
      "description": "Pre-commit hook must complete quickly"
    },
    "ci_cd": {
      "max_total_test_time_minutes": 10,
      "description": "CI/CD validation time budget"
    }
  },

  "notes": "Budgets based on real measurements from 2025-10-18 validation session. Update as optimizations are implemented."
}
