# Z-Library MCP Server Docker Compose
#
# Usage:
#   1. Copy env.example to .env and fill in credentials
#   2. docker compose -f docker/docker-compose.yaml up -d
#
# The server will be available at http://localhost:8000

services:
  zlibrary-mcp:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    image: zlibrary-mcp:latest
    container_name: zlibrary-mcp
    restart: unless-stopped
    ports:
      - "8000:8000"
    env_file:
      - .env
    volumes:
      # Mount local directory for downloaded books
      - ./downloads:/app/downloads
    # SuperGateway options for HTTP transport
    command: >
      --port 8000
      --host 0.0.0.0
      --healthEndpoint /health
      --stdio "node /app/dist/index.js"
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
